<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Iframe Crash Simulation (Two Column)</title>
<style>
    body {
        font-family: sans-serif;
        padding: 15px;
        background-color: #f0f0f0;
        margin: 0;
        color: #333;
    }

    /* Main container for two columns */
    .main-container {
        display: flex;
        flex-wrap: wrap; /* Allow columns to stack when space is insufficient */
        gap: 25px; /* Space between columns */
        max-width: 1300px; /* Max overall width */
        margin: 0 auto; /* Center the container */
        align-items: flex-start;
    }

    /* Styling for columns */
    .column {
        background-color: #fff;
        padding: 20px;
        border-radius: 8px;
        box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        flex-shrink: 1; /* Allow columns to shrink */
        flex-basis: 0; /* Let grow factor primarily determine size */
        box-sizing: border-box; /* INCLUDE padding/border in width calculation */
        min-width: 280px; /* Minimum width before wrapping - ADJUST AS NEEDED */
    }

    .column-1 {
        flex-grow: 2; /* Make col 1 take ~2/3 of available space */
        /* Contains the browser window and its controls */
        /* min-width can be specifically set here if different from col-2 */
         min-width: 320px; /* Example: ensure browser window has enough min space */
    }

    .column-2 {
        flex-grow: 1; /* Make col 2 take ~1/3 of available space */
         /* min-width: 280px; /* Inherited from .column */
        display: none; /* Initially hidden */
    }

    /* --- Column 1 Content --- */
    .browser-window {
        position: relative;
        width: 100%; /* Fill column width */
        height: 500px;
        border: 1px solid #aaa;
        background-color: #fff;
        margin: 0 0 15px 0;
        box-shadow: 0 4px 12px rgba(0,0,0,0.2);
        border-radius: 8px;
        overflow: hidden;
    }
    .title-bar { /* Styles remain the same */
        background-color: #ddd; height: 30px; display: flex; align-items: center;
        padding: 0 10px; border-bottom: 1px solid #ccc; flex-shrink: 0;
    }
    .buttons { display: flex; gap: 6px; margin-right: 10px; }
    .dot { width: 12px; height: 12px; border-radius: 50%; flex-shrink: 0; }
    .red { background-color: #ff5f57; } .yellow { background-color: #ffbd2e; } .green { background-color: #28c940; }
    .tab-title { /* Styles remain the same */
        font-size: 0.8em; color: #333; background-color: #eee; padding: 4px 10px;
        border-radius: 4px 4px 0 0; position: relative; top: 1px; white-space: nowrap;
        overflow: hidden; text-overflow: ellipsis;
    }
    #targetIframe { /* Styles remain the same */
        width: 100%; height: calc(100% - 30px); border: none; display: block;
    }
    #crashOverlay { /* Styles remain mostly the same */
        position: absolute; top: 0; left: 0; width: 100%; height: 100%;
        background-color: rgba(50, 50, 50, 0.9); color: #eee;
        justify-content: center; align-items: center; text-align: center;
        font-size: 1.5em; display: flex; flex-direction: column;
        visibility: hidden; opacity: 0;
        transition: opacity 0.3s ease-in-out, visibility 0.3s ease-in-out;
        z-index: 10; border-radius: 8px; padding: 20px; box-sizing: border-box;
    }
    #crashOverlay.visible { visibility: visible; opacity: 1; }
    .sad-icon { font-size: 3em; margin-bottom: 15px; color: #ffcc00; }
    .murphy-in-overlay { /* Styles remain the same */
        font-size: 0.6em; margin-top: 20px; font-style: italic; color: #ccc;
    }

    .col1-controls { /* Styles remain the same */
        text-align: center;
    }
    .col1-controls button { /* Styles remain the same */
        padding: 10px 15px; font-size: 1em; cursor: pointer; margin: 5px;
    }

    /* --- Column 2 Content --- */
    #crashReasonsCol h2 { /* Styles remain the same */
        margin-top: 0; color: #c0392b; border-bottom: 1px solid #eee; padding-bottom: 10px;
    }
    #crashReasonsCol ul { /* Styles remain the same */
        list-style: none; padding: 0; margin: 0;
    }
    #crashReasonsCol li { /* Styles remain the same */
        background-color: #f9f9f9; border: 1px solid #eee; padding: 10px;
        margin-bottom: 8px; border-radius: 4px; font-size: 0.9em;
    }
    #crashReasonsCol li strong { color: #555; }

    /* Responsive adjustments */
    /* Stacking occurs when container width < sum of min-widths + gap */
    /* Example: 320 (col1 min) + 280 (col2 min) + 25 (gap) = 625px */
    @media (max-width: 625px) {
        /* No specific flex rules needed here, flex-wrap: wrap handles stacking */
        .browser-window {
            height: 450px; /* Adjust height for stacked view */
        }
    }
    @media (max-width: 400px) {
        .browser-window {
            height: 400px;
        }
         #crashOverlay { font-size: 1.2em; }
        .col1-controls button { font-size: 0.9em; }
    }
    /* --- END OF UPDATED CSS RULES --- */

</style>
</head>
<body>

<div class="main-container">

    <div class="column column-1">
        <div class="browser-window">
            <div class="title-bar">
                <div class="buttons">
                    <span class="dot red"></span>
                    <span class="dot yellow"></span>
                    <span class="dot green"></span>
                </div>
                <span class="tab-title">Admin Dashboard</span>
            </div>
            <iframe id="targetIframe" src="admin_panel.html" title="Admin Dashboard Content"></iframe>

            <div id="crashOverlay">
                <div class="sad-icon">:(</div>
                <div>The 'Admin Dashboard' tab has crashed.</div>
                <div style="font-size: 0.7em; margin-top: 10px;">(This is a simulation)</div>
                <div class="murphy-in-overlay">Murphy's Law: If anything can go wrong, it will.</div>
            </div>
        </div>

        <div class="col1-controls">
            <button id="simulateCrashBtnParent">Simulate Crash (Parent Button)</button>
            <button id="resetBtn">Reset Iframe</button>
        </div>
    </div>

    <div class="column column-2" id="crashReasonsCol">
        <h2>Possible Crash Reasons</h2>
        <ul>
            <li><strong>Script Timeout:</strong> An operation took too long (e.g., infinite loop).</li>
            <li><strong>Memory Exhaustion:</strong> The page used too much memory allocation.</li>
            <li><strong>Rendering Issue:</strong> Complex CSS or canvas operations failed.</li>
            <li><strong>Network Error:</strong> Failed to load critical resources.</li>
            <li><strong>Browser Bug:</strong> An underlying issue in the browser itself.</li>
            <li><strong>Resource Limit:</strong> Exceeded limits set by the browser or OS.</li>
        </ul>
        <p style="font-size: 0.8em; margin-top: 15px; color: #777;">(These are common examples, the actual cause may vary)</p>
    </div>

</div>


<script>
  const overlay = document.getElementById('crashOverlay');
  const simulateBtnParent = document.getElementById('simulateCrashBtnParent');
  const resetBtn = document.getElementById('resetBtn');
  const iframe = document.getElementById('targetIframe');
  const crashReasonsCol = document.getElementById('crashReasonsCol'); // Get Column 2 element

  // Function to show the overlay AND Crash Reasons column
  function showCrashSimulation() {
      overlay.classList.add('visible');
      crashReasonsCol.style.display = 'block'; // Show Column 2
      console.log('PARENT: Crash simulation activated.');
  }

  // Function to hide the overlay AND Crash Reasons column, and reset iframe
  function resetSimulation() {
      overlay.classList.remove('visible');
      crashReasonsCol.style.display = 'none'; // Hide Column 2
      // Force iframe reload to truly reset its state
      iframe.src = iframe.src; // Reloads admin_panel.html
      console.log('PARENT: Simulation reset and iframe reloaded.');
  }

  // Listener for the PARENT's simulate button
  simulateBtnParent.addEventListener('click', showCrashSimulation);

  // Listener for the reset button
  resetBtn.addEventListener('click', resetSimulation);

  // Listener for messages from the iframe (to trigger the crash simulation)
  window.addEventListener('message', (event) => {
    // SECURITY NOTE: Check event.origin in production!
    if (event.data === 'simulateCrashRequest') {
      console.log('PARENT: Received "simulateCrashRequest" message from iframe.');
      showCrashSimulation(); // Activate the simulation
    }
  });
</script>

</body>
</html>
